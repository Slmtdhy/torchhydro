import os
import pytest

from torchhydro.configs.config import cmd, default_config_file
from torchhydro import SETTING


@pytest.fixture()
def config_data():
    return default_config_file()


@pytest.fixture()
def args():
    project_name = "test_camels/exp1"
    data_dir = SETTING["local_data_path"]["datasets-origin"]
    source_path = os.path.join(data_dir, "camels", "camels_us")
    return cmd(
        sub=project_name,
        source_cfgs={
            "source_name": "camels_us",
            "source_path": source_path,
        },
        ctx=[-1],
        model_name="CpuLSTM",
        model_hyperparam={
            "n_input_features": 23,
            "n_output_features": 1,
            "n_hidden_states": 256,
        },
        gage_id=[
            "01013500",
            "01022500",
            "01030500",
            "01031500",
            "01047000",
            "01052500",
            "01054200",
            "01055000",
            "01057000",
            "01170100",
        ],
        batch_size=8,
        rho=20,
        var_t=["dayl", "prcp", "srad", "tmax", "tmin", "vp"],
        # var_c=["None"],
        var_out=["streamflow"],
        dataset="StreamflowDataset",
        sampler="KuaiSampler",
        scaler="DapengScaler",
        train_epoch=2,
        save_epoch=1,
        model_loader={"load_way": "specified", "test_epoch": 2},
        train_period=["2000-10-01", "2001-10-01"],
        valid_period=["2001-10-01", "2002-10-01"],
        test_period=["2002-10-01", "2003-10-01"],
        loss_func="RMSESum",
        opt="Adam",
        # key is epoch, start from 0, each value means the decay rate
        lr_scheduler={0: 1, 1: 0.5, 2: 0.2},
        which_first_tensor="sequence",
    )


@pytest.fixture()
def mtl_args():
    project_name = "test_camels/expmtl001"
    data_origin_dir = SETTING["local_data_path"]["datasets-origin"]
    data_interim_dir = SETTING["local_data_path"]["datasets-interim"]
    return cmd(
        sub=project_name,
        source_cfgs={
            "source_names": [
                "usgs4camels",
                "modiset4camels",
                "nldas4camels",
                "smap4camels",
            ],
            "source_paths": [
                os.path.join(data_origin_dir, "camels", "camels_us"),
                os.path.join(data_interim_dir, "camels_us", "modiset4camels"),
                os.path.join(data_interim_dir, "camels_us", "nldas4camels"),
                os.path.join(data_interim_dir, "camels_us", "smap4camels"),
            ],
        },
        ctx=[0],
        model_type="MTL",
        model_name="KuaiLSTMMultiOut",
        model_hyperparam={
            "n_input_features": 23,
            "n_output_features": 2,
            "n_hidden_states": 64,
            "layer_hidden_size": 32,
        },
        loss_func="MultiOutLoss",
        loss_param={
            "loss_funcs": "RMSESum",
            "data_gap": [0, 2],
            "device": [0],
            "item_weight": [1.0, 0.0],
            "limit_part": [1],
        },
        gage_id=[
            "01013500",
            "01022500",
            "01030500",
            "01031500",
            "01047000",
            "01052500",
            "01054200",
            "01055000",
            "01057000",
            "01170100",
        ],
        batch_size=5,
        rho=30,  # batch_size=100, rho=365,
        var_t=[
            "temperature",
            "specific_humidity",
            "shortwave_radiation",
            "potential_energy",
            "potential_evaporation",
            "total_precipitation",
        ],
        var_t_type=["nldas"],
        var_out=["streamflow", "ET"],
        var_to_source_map={
            "temperature": "nldas4camels",
            "specific_humidity": "nldas4camels",
            "shortwave_radiation": "nldas4camels",
            "potential_energy": "nldas4camels",
            "potential_evaporation": "nldas4camels",
            "total_precipitation": "nldas4camels",
            "streamflow": "usgs4camels",
            "ET": "modiset4camels",
            "elev_mean": "usgs4camels",
            "slope_mean": "usgs4camels",
            "area_gages2": "usgs4camels",
            "frac_forest": "usgs4camels",
            "lai_max": "usgs4camels",
            "lai_diff": "usgs4camels",
            "dom_land_cover_frac": "usgs4camels",
            "dom_land_cover": "usgs4camels",
            "root_depth_50": "usgs4camels",
            "soil_depth_statsgo": "usgs4camels",
            "soil_porosity": "usgs4camels",
            "soil_conductivity": "usgs4camels",
            "max_water_content": "usgs4camels",
            "geol_1st_class": "usgs4camels",
            "geol_2nd_class": "usgs4camels",
            "geol_porostiy": "usgs4camels",
            "geol_permeability": "usgs4camels",
        },
        train_period=["2015-04-01", "2016-04-01"],
        test_period=["2016-04-01", "2017-04-01"],
        dataset="FlexDataset",
        sampler="KuaiSampler",
        scaler="DapengScaler",
        n_output=2,
        train_epoch=2,
        fill_nan=["no", "mean"],
        model_loader={"load_way": "specified", "test_epoch": 2},
    )


@pytest.fixture()
def fusion_cnn_lstm_args():
    project_name = "test_fusion/exp002"
    multi_source_origin_dir = SETTING["local_data_path"]["datasets-origin"]
    multi_source_interim_dir = SETTING["local_data_path"]["datasets-interim"]
    return cmd(
        sub=project_name,
        source_cfgs={
            "source_names": [
                "gages",
                "mopex",
            ],
            "source_paths": [
                os.path.join(multi_source_origin_dir, "gages"),
                os.path.join(multi_source_interim_dir, "mopex"),
            ],
        },
        ctx=[-1],
        model_type="Normal",
        # model_name="ChuFusion",
        model_name="CNNLSTM",
        # model_hyperparam={
        #     "num_sources": 4,
        #     "out_channels": 2,
        #     "transformer_heads": 4,
        #     "transformer_layers": 2,
        #     "n_input_features": 23,
        #     "n_output_features": 2,
        #     "n_hidden_states": 64,
        #     "layer_hidden_size": 32,
        #     "kernel_size_hydrograph": 3,
        #     "warmup_length": 365,
        #     "param_limit_func": "sigmoid",
        #     "param_test_way": "final",
        #     "source_book": "HF",
        #     "source_type": "sources",
        #     "kernel_size": 3,
        #     "padding": 1,
        # },
        model_hyperparam={
            "n_input_features": 52,
            "n_output_features": 1,
            "n_hidden_states": 256,
        },
        loss_func="RMSESum",
        gage_id=[
            "02475500",
            "03069000",
            "06894000",
            "05554500",
            "13298500",
            "01560000",
            "01064500",
            "02383500",
            "03238500",
            "05592500",
            "03473000",
            "05585000",
            "03339500",
            "13340600",
            "13336500",
            "03198500",
            "07147800",
            "06480000",
            "03159500",
            "05412500",
            "03136000",
            "05484500",
            "05455500",
            "05517000",
            "01127000",
            "03184000",
            "02228000",
            "01556000",
            "01055500",
            "02102000",
            "07340000",
            "01541000",
            "06799500",
            "02414500",
            "01595000",
            "02143040",
            "03054500",
            "03451500",
            "03528000",
            "03265000",
            "07057500",
            "07147070",
            "11501000",
            "01534000",
            "04221500",
            "11532500",
            "12144500",
            "06860000",
            "08095000",
            "05593000",
            "01667500",
            "03179000",
            "06359500",
            "01559000",
            "05569500",
            "12027500",
            "04079000",
            "11160000",
            "01329000",
            "08150000",
            "12358500",
            "03603000",
            "01426500",
            "03274000",
            "06606600",
            "06817500",
            "07197000",
            "03345500",
            "01608500",
            "03237500",
            "01541500",
            "02143500",
            "08189500",
            "06888500",
            "05584500",
            "03448000",
            "02135000",
            "08055500",
            "03361500",
            "11281000",
            "03020500",
            "06607200",
            "03252500",
            "06441500",
            "06334500",
            "08103800",
            "11213500",
            "03269500",
            "14308000",
            "03175500",
            "01611500",
            "05383000",
            "05570000",
            "03438000",
            "01060000",
            "11080500",
            "01634000",
            "06914000",
            "07348000",
            "11427000",
            "03524000",
            "07068000",
            "08085500",
            "03199000",
            "06847000",
            "04191500",
            "03574500",
            "02296750",
            "05552500",
            "06908000",
            "04073500",
            "01531000",
            "08172000",
            "02219500",
            "04178000",
            "06885500",
            "02347500",
            "01076500",
            "07058000",
            "02478500",
            "05451500",
            "01674500",
            "07056000",
            "03324300",
            "06817000",
            "14080500",
            "12449500",
            "08340500",
            "01197500",
            "07177500",
            "05582000",
            "09132500",
            "04212000",
            "02202500",
            "02479300",
            "03455000",
            "01520500",
            "01610000",
            "05526000",
            "06446000",
            "02143000",
            "01672500",
            "05520500",
            "03443000",
            "09442692",
            "03079000",
            "03326500",
            "12413500",
            "02083500",
            "03532000",
            "06883000",
            "03303000",
            "06225500",
            "02016000",
            "05472500",
            "05508000",
            "03109500",
            "01520000",
            "06808500",
            "04223000",
            "03011020",
            "02165000",
            "12413000",
            "13186000",
            "07346050",
            "06928000",
            "08146000",
            "07144780",
            "07163000",
            "06454500",
            "03253500",
            "02126000",
            "04221000",
            "11342000",
            "14233400",
            "01321000",
            "03213000",
            "03331500",
            "13337000",
            "14232500",
            "02482000",
            "03183500",
            "03328500",
            "02018000",
            "03114500",
            "02492000",
            "03348000",
            "05410490",
            "07069500",
            "03070000",
            "01334500",
            "04165500",
            "01663500",
            "01548500",
            "11138500",
            "05555500",
            "01606500",
            "03362500",
            "09299500",
            "07186000",
            "08150700",
            "03065000",
            "12449950",
            "03364000",
            "02339500",
            "02387500",
            "03161000",
            "07019000",
            "05452000",
            "13200000",
            "01518000",
            "03540500",
            "05418500",
            "07346000",
            "02118000",
            "05481000",
            "05440000",
            "03050500",
            "07243500",
            "05514500",
            "01558000",
            "04183500",
            "09251000",
            "09431500",
            "02192000",
            "06892000",
            "03512000",
            "04144000",
            "01500500",
            "07252000",
            "05471500",
            "11355500",
            "12462500",
            "03470000",
            "03069500",
            "09430500",
            "07152000",
            "03410500",
            "02055000",
            "05518000",
            "03266000",
            "05435500",
            "05430500",
            "06884400",
            "03531500",
            "06897500",
            "09444500",
            "10296000",
            "05454500",
            "01348000",
            "01371500",
            "03032500",
            "01138000",
            "05053000",
            "11025500",
            "01421000",
            "05280000",
            "07029500",
            "06191500",
            "03567500",
            "14101500",
            "03168000",
            "10309000",
            "07363500",
            "06813000",
            "11401500",
            "05462000",
            "02448000",
            "03308500",
            "06913500",
            "06600500",
            "12459000",
            "10301500",
            "01631000",
            "04198000",
            "08171300",
            "07221000",
            "02486000",
            "06609500",
            "03010500",
            "03075500",
            "03550000",
            "05555300",
            "08171000",
            "13340500",
            "02475000",
            "05476500",
            "03251500",
            "03521500",
            "13351000",
            "03051000",
            "07183000",
            "02329000",
            "05244000",
            "01574000",
            "03301500",
            "07378000",
            "02375500",
            "06898000",
            "01514000",
            "02138500",
            "02217500",
            "03214000",
            "07144200",
            "09497500",
            "12340000",
            "02236000",
            "03167000",
            "08015500",
            "02030500",
            "08167500",
            "05502040",
            "07378500",
            "06811500",
            "13302500",
            "03024000",
            "14359000",
            "07375500",
            "01668000",
            "01423000",
            "01543500",
            "06426500",
            "04164000",
            "06869500",
            "05320500",
            "08013500",
            "11224500",
            "07074000",
            "03281500",
            "01048000",
            "03465500",
            "02273000",
            "07049000",
            "09292500",
            "07307800",
            "04100500",
            "05422000",
            "05594000",
            "10296500",
            "11413000",
            "04201500",
            "02456500",
            "07288500",
            "03173000",
            "07211500",
            "07289500",
            "03365500",
            "08033500",
            "01512500",
            "04176500",
            "11403000",
            "02218500",
            "04113000",
            "03182500",
            "03349000",
            "06192500",
            "05542000",
            "02174000",
            "03186500",
            "11530000",
            "06815000",
            "03180500",
            "14321000",
            "03155500",
            "03346000",
            "11497500",
            "07346070",
            "03490000",
            "05408000",
            "03361650",
            "05458500",
            "01628500",
            "05457700",
            "01643000",
            "12149000",
            "01649500",
            "06933500",
            "07222500",
            "01445500",
            "01503000",
            "02116500",
            "02472000",
            "05447500",
            "03111500",
            "06810000",
            "06899500",
            "03289500",
            "02387000",
            "03504000",
            "12098500",
            "01664000",
            "07067000",
            "06820500",
            "03381500",
            "06340500",
            "01567000",
            "08205500",
            "12134500",
            "04185000",
            "05517500",
            "07172000",
            "07196500",
            "05482500",
            "04115000",
            "05479000",
            "08032000",
            "14113000",
            "01372500",
            "07052500",
            "03165500",
            "02365500",
            "07072000",
            "07261000",
            "01445000",
            "02058400",
            "02349500",
            "01200000",
            "05507500",
            "07290000",
            "05515500",
            "02156500",
            "03363000",
            "01562000",
            "10312000",
            "01329500",
            "03164000",
        ],
        batch_size=8,
        rho=20,
        var_t=[
            "prcp",
            "map",
            "dayl",
            "srad",
            "swe",
            "tmax",
            "tmin",
            "vp",
        ],
        # var_t_type=["nldas"],
        var_out=["streamflow"],
        var_c=[
            "DRAIN_SQKM",
            "PPTAVG_BASIN",
            "T_AVG_BASIN",
            "T_MAX_BASIN",
            "T_MAXSTD_BASIN",
            "T_MIN_BASIN",
            "T_MINSTD_BASIN",
            "RH_BASIN",
            "PET",
            "GEOL_REEDBUSH_DOM",
            "GEOL_REEDBUSH_DOM_PCT",
            "BFI_AVE",
            "PERDUN",
            "PERHOR",
            "TOPWET",
            "CONTACT",
            "RUNAVE7100",
            "DEVNLCD06",
            "FORESTNLCD06",
            "PLANTNLCD06",
            "IMPNLCD06",
            "HGA",
            "HGB",
            "HGAD",
            "HGC",
            "HGD",
            "HGAC",
            "HGBD",
            "HGCD",
            "HGBC",
            "HGVAR",
            "AWCAVE",
            "PERMAVE",
            "BDAVE",
            "WTDEPAVE",
            "ROCKDEPAVE",
            "ELEV_MEAN_M_BASIN",
            "ELEV_MAX_M_BASIN",
            "ELEV_MIN_M_BASIN",
            "ELEV_MEDIAN_M_BASIN",
            "ELEV_STD_M_BASIN",
            "RRMEAN",
            "RRMEDIAN",
            "SLOPE_PCT",
        ],
        var_to_source_map={
            "dayl(s)": "gages",
            "prcp(mm/day)": "gages",
            "srad(W/m2)": "gages",
            "swe(mm)": "gages",
            "tmax(C)": "gages",
            "tmin(C)": "gages",
            "vp(Pa)": "gages",
            "map(mm/day)": "mopex",
            "pe(mm/day)": "mopex",
            "DRAIN_SQKM": "gages",
            "PPTAVG_BASIN": "gages",
            "T_AVG_BASIN": "gages",
            "T_MAX_BASIN": "gages",
            "T_MAXSTD_BASIN": "gages",
            "T_MIN_BASIN": "gages",
            "T_MINSTD_BASIN": "gages",
            "RH_BASIN": "gages",
            "PET": "gages",
            "GEOL_REEDBUSH_DOM": "gages",
            "GEOL_REEDBUSH_DOM_PCT": "gages",
            "BFI_AVE": "gages",
            "PERDUN": "gages",
            "PERHOR": "gages",
            "TOPWET": "gages",
            "CONTACT": "gages",
            "RUNAVE7100": "gages",
            "DEVNLCD06": "gages",
            "FORESTNLCD06": "gages",
            "PLANTNLCD06": "gages",
            "IMPNLCD06": "gages",
            "HGA": "gages",
            "HGB": "gages",
            "HGAD": "gages",
            "HGC": "gages",
            "HGD": "gages",
            "HGAC": "gages",
            "HGBD": "gages",
            "HGCD": "gages",
            "HGBC": "gages",
            "HGVAR": "gages",
            "AWCAVE": "gages",
            "PERMAVE": "gages",
            "BDAVE": "gages",
            "WTDEPAVE": "gages",
            "ROCKDEPAVE": "gages",
            "ELEV_MEAN_M_BASIN": "gages",
            "ELEV_MAX_M_BASIN": "gages",
            "ELEV_MIN_M_BASIN": "gages",
            "ELEV_MEDIAN_M_BASIN": "gages",
            "ELEV_STD_M_BASIN": "gages",
            "RRMEAN": "gages",
            "RRMEDIAN": "gages",
            "SLOPE_PCT": "gages",
        },
        train_period=["2000-04-01", "2001-04-01"],
        test_period=["2001-04-01", "2002-04-01"],
        dataset="PrecipitationFusionDataset",
        sampler="KuaiSampler",
        scaler="DapengScaler",
        n_output=1,
        opt="Adam",
        train_epoch=2,
        fill_nan=["no", "mean"],
        model_loader={"load_way": "specified", "test_epoch": 2},
        lr_scheduler={0: 1, 1: 0.5, 2: 0.2},
        which_first_tensor="sequence",
    )

@pytest.fixture()
def fusion_lstm_args():
    project_name = "test_fusion/exp001"
    multi_source_origin_dir = SETTING["local_data_path"]["datasets-origin"]
    multi_source_interim_dir = SETTING["local_data_path"]["datasets-interim"]
    return cmd(
        sub=project_name,
        source_cfgs={
            "source_names": [
                "gages",
                "mopex",
            ],
            "source_paths": [
                os.path.join(multi_source_origin_dir, "gages"),
                os.path.join(multi_source_interim_dir, "mopex"),
            ],
        },
        ctx=[0],
        model_type="Normal",
        # model_name="ChuFusion",
        model_name="CoupledLSTM",
        # model_hyperparam={
        #     "num_sources": 4,
        #     "out_channels": 2,
        #     "transformer_heads": 4,
        #     "transformer_layers": 2,
        #     "n_input_features": 23,
        #     "n_output_features": 2,
        #     "n_hidden_states": 64,
        #     "layer_hidden_size": 32,
        #     "kernel_size_hydrograph": 3,
        #     "warmup_length": 365,
        #     "param_limit_func": "sigmoid",
        #     "param_test_way": "final",
        #     "source_book": "HF",
        #     "source_type": "sources",
        #     "kernel_size": 3,
        #     "padding": 1,
        # },
        model_hyperparam={
            "precipitation_fusion_input_feature": 2,
            "precipitation_fusion_output_feature": 1,
            "precipitation_fusion_hidden_states": 256,
            "flow_prediction_input_feature": 51,
            "flow_prediction_output_feature": 1,
            "flow_prediction_hidden_states": 256,
        },
        loss_func="RMSESum",
        # gage_id=[
        #     "02475500",
        #     "03069000",
        #     "06894000",
        #     "05554500",
        #     "13298500",
        #     "01560000",
        #     "01064500",
        #     "02383500",
        #     "03238500",
        #     "05592500",],
        gage_id=[
            "01060000",
            "01064500",
            "01076500",
            "01127000",
            "01197500",
            "01321000",
            "01334500",
            "01371500",
            "01372500",
            "01421000",
            "01423000",
            "01426500",
            "01445500",
            "01503000",
            "01512500",
            "01518000",
            "01520000",
            "01531000",
            "01534000",
            "01541000",
            "01541500",
            "01543500",
            "01548500",
            "01556000",
            "01558000",
            "01559000",
            "01560000",
            "01562000",
            "01567000",
            "01574000",
            "01595000",
            "01606500",
            "01608500",
            "01610000",
            "01628500",
            "01631000",
            "01634000",
            "01643000",
            "01649500",
            "01664000",
            "01667500",
            "01668000",
            "01674500",
            "02016000",
            "02018000",
            "02058400",
            "02083500",
            "02102000",
            "02116500",
            "02118000",
            "02126000",
            "02135000",
            "02138500",
            "02143000",
            "02143040",
            "02143500",
            "02156500",
            "02165000",
            "02192000",
            "02202500",
            "02217500",
            "02228000",
            "02236000",
            "02273000",
            "02296750",
            "02329000",
            "02339500",
            "02347500",
            "02349500",
            "02375500",
            "02383500",
            "02387000",
            "02387500",
            "02414500",
            "02472000",
            "02475000",
            "02475500",
            "02478500",
            "02479300",
            "02482000",
            "02492000",
            "03010500",
            "03011020",
            "03020500",
            "03024000",
            "03032500",
            "03050500",
            "03051000",
            "03054500",
            "03069500",
            "03075500",
            "03079000",
            "03109500",
            "03111500",
            "03159500",
            "03161000",
            "03164000",
            "03168000",
            "03173000",
            "03179000",
            "03180500",
            "03182500",
            "03183500",
            "03184000",
            "03186500",
            "03198500",
            "03237500",
            "03238500",
            "03265000",
            "03266000",
            "03269500",
            "03274000",
            "03281500",
            "03301500",
            "03303000",
            "03324300",
            "03326500",
            "03328500",
            "03331500",
            "03339500",
            "03345500",
            "03346000",
            "03349000",
            "03361500",
            "03361650",
            "03362500",
            "03364000",
            "03365500",
            "03381500",
            "03410500",
            "03438000",
            "03443000",
            "03451500",
            "03465500",
            "03473000",
            "03504000",
            "03512000",
            "03524000",
            "03528000",
            "03531500",
            "03540500",
            "03550000",
            "03574500",
            "04073500",
            "04079000",
            "04100500",
            "04113000",
            "04115000",
            "04164000",
            "04165500",
            "04176500",
            "04178000",
            "04185000",
            "04191500",
            "04198000",
            "04201500",
            "04221000",
            "04223000",
            "05053000",
            "05280000",
            "05320500",
            "05408000",
            "05410490",
            "05412500",
            "05418500",
            "05422000",
            "05430500",
            "05435500",
            "05440000",
            "05447500",
            "05451500",
            "05452000",
            "05454500",
            "05455500",
            "05458500",
            "05471500",
            "05472500",
            "05479000",
            "05481000",
            "05482500",
            "05484500",
            "05508000",
            "05514500",
            "05515500",
            "05517000",
            "05517500",
            "05518000",
            "05520500",
            "05526000",
            "05552500",
            "05554500",
            "05555300",
            "05569500",
            "05570000",
            "05582000",
            "05584500",
            "05585000",
            "05592500",
            "05593000",
            "05594000",
            "06191500",
            "06192500",
            "06225500",
            "06334500",
            "06340500",
            "06359500",
            "06441500",
            "06446000",
            "06480000",
            "06600500",
            "06606600",
            "06607200",
            "06609500",
            "06799500",
            "06808500",
            "06810000",
            "06811500",
            "06815000",
            "06817000",
            "06820500",
            "06860000",
            "06869500",
            "06883000",
            "06884400",
            "06885500",
            "06888500",
            "06892000",
            "06894000",
            "06897500",
            "06898000",
            "06899500",
            "06908000",
            "06913500",
            "06933500",
            "07019000",
            "07029500",
            "07052500",
            "07056000",
            "07057500",
            "07067000",
            "07068000",
            "07144200",
            "07144780",
            "07147070",
            "07147800",
            "07152000",
            "07172000",
            "07177500",
            "07183000",
            "07186000",
            "07196500",
            "07197000",
            "07211500",
            "07243500",
            "07261000",
            "07290000",
            "07307800",
            "07340000",
            "07346070",
            "07363500",
            "07375500",
            "07378000",
            "07378500",
            "08015500",
            "08033500",
            "08055500",
            "08085500",
            "08095000",
            "08103800",
            "08167500",
            "08171000",
            "08171300",
            "08172000",
            "08189500",
            "09132500",
            "09251000",
            "09292500",
            "09299500",
            "09430500",
            "09431500",
            "09444500",
            "09497500",
            "10296000",
            "10296500",
            "10301500",
            "10309000",
            "10312000",
            "11025500",
            "11160000",
            "11224500",
            "11342000",
            "11413000",
            "11427000",
            "11501000",
            "11530000",
            "11532500",
            "12027500",
            "12098500",
            "12134500",
            "12144500",
            "12149000",
            "12340000",
            "12358500",
            "12413000",
            "12449950",
            "12459000",
            "12462500",
            "13186000",
            "13200000",
            "13302500",
            "13336500",
            "13337000",
            "13340600",
            "13351000",
            "14113000",
            "14308000",
            "14321000",
            "14359000",
        ],
        # gage_id=[
        #     "02475500",
        #     "03069000",
        #     "06894000",
        #     "05554500",
        #     "13298500",
        #     "01560000",
        #     "01064500",
        #     "02383500",
        #     "03238500",
        #     "05592500",
        #     "03473000",
        #     "05585000",
        #     "03339500",
        #     "13340600",
        #     "13336500",
        #     "03198500",
        #     "07147800",
        #     "06480000",
        #     "03159500",
        #     "05412500",
        #     "03136000",
        #     "05484500",
        #     "05455500",
        #     "05517000",
        #     "01127000",
        #     "03184000",
        #     "02228000",
        #     "01556000",
        #     "01055500",
        #     "02102000",
        #     "07340000",
        #     "01541000",
        #     "06799500",
        #     "02414500",
        #     "01595000",
        #     "02143040",
        #     "03054500",
        #     "03451500",
        #     "03528000",
        #     "03265000",
        #     "07057500",
        #     "07147070",
        #     "11501000",
        #     "01534000",
        #     "04221500",
        #     "11532500",
        #     "12144500",
        #     "06860000",
        #     "08095000",
        #     "05593000",
        #     "01667500",
        #     "03179000",
        #     "06359500",
        #     "01559000",
        #     "05569500",
        #     "12027500",
        #     "04079000",
        #     "11160000",
        #     "01329000",
        #     "08150000",
        #     "12358500",
        #     "03603000",
        #     "01426500",
        #     "03274000",
        #     "06606600",
        #     "06817500",
        #     "07197000",
        #     "03345500",
        #     "01608500",
        #     "03237500",
        #     "01541500",
        #     "02143500",
        #     "08189500",
        #     "06888500",
        #     "05584500",
        #     "03448000",
        #     "02135000",
        #     "08055500",
        #     "03361500",
        #     "11281000",
        #     "03020500",
        #     "06607200",
        #     "03252500",
        #     "06441500",
        #     "06334500",
        #     "08103800",
        #     "11213500",
        #     "03269500",
        #     "14308000",
        #     "03175500",
        #     "01611500",
        #     "05383000",
        #     "05570000",
        #     "03438000",
        #     "01060000",
        #     "11080500",
        #     "01634000",
        #     "06914000",
        #     "07348000",
        #     "11427000",
        #     "03524000",
        #     "07068000",
        #     "08085500",
        #     "03199000",
        #     "06847000",
        #     "04191500",
        #     "03574500",
        #     "02296750",
        #     "05552500",
        #     "06908000",
        #     "04073500",
        #     "01531000",
        #     "08172000",
        #     "02219500",
        #     "04178000",
        #     "06885500",
        #     "02347500",
        #     "01076500",
        #     "07058000",
        #     "02478500",
        #     "05451500",
        #     "01674500",
        #     "07056000",
        #     "03324300",
        #     "06817000",
        #     "14080500",
        #     "12449500",
        #     "08340500",
        #     "01197500",
        #     "07177500",
        #     "05582000",
        #     "09132500",
        #     "04212000",
        #     "02202500",
        #     "02479300",
        #     "03455000",
        #     "01520500",
        #     "01610000",
        #     "05526000",
        #     "06446000",
        #     "02143000",
        #     "01672500",
        #     "05520500",
        #     "03443000",
        #     "09442692",
        #     "03079000",
        #     "03326500",
        #     "12413500",
        #     "02083500",
        #     "03532000",
        #     "06883000",
        #     "03303000",
        #     "06225500",
        #     "02016000",
        #     "05472500",
        #     "05508000",
        #     "03109500",
        #     "01520000",
        #     "06808500",
        #     "04223000",
        #     "03011020",
        #     "02165000",
        #     "12413000",
        #     "13186000",
        #     "07346050",
        #     "06928000",
        #     "08146000",
        #     "07144780",
        #     "07163000",
        #     "06454500",
        #     "03253500",
        #     "02126000",
        #     "04221000",
        #     "11342000",
        #     "14233400",
        #     "01321000",
        #     "03213000",
        #     "03331500",
        #     "13337000",
        #     "14232500",
        #     "02482000",
        #     "03183500",
        #     "03328500",
        #     "02018000",
        #     "03114500",
        #     "02492000",
        #     "03348000",
        #     "05410490",
        #     "07069500",
        #     "03070000",
        #     "01334500",
        #     "04165500",
        #     "01663500",
        #     "01548500",
        #     "11138500",
        #     "05555500",
        #     "01606500",
        #     "03362500",
        #     "09299500",
        #     "07186000",
        #     "08150700",
        #     "03065000",
        #     "12449950",
        #     "03364000",
        #     "02339500",
        #     "02387500",
        #     "03161000",
        #     "07019000",
        #     "05452000",
        #     "13200000",
        #     "01518000",
        #     "03540500",
        #     "05418500",
        #     "07346000",
        #     "02118000",
        #     "05481000",
        #     "05440000",
        #     "03050500",
        #     "07243500",
        #     "05514500",
        #     "01558000",
        #     "04183500",
        #     "09251000",
        #     "09431500",
        #     "02192000",
        #     "06892000",
        #     "03512000",
        #     "04144000",
        #     "01500500",
        #     "07252000",
        #     "05471500",
        #     "11355500",
        #     "12462500",
        #     "03470000",
        #     "03069500",
        #     "09430500",
        #     "07152000",
        #     "03410500",
        #     "02055000",
        #     "05518000",
        #     "03266000",
        #     "05435500",
        #     "05430500",
        #     "06884400",
        #     "03531500",
        #     "06897500",
        #     "09444500",
        #     "10296000",
        #     "05454500",
        #     "01348000",
        #     "01371500",
        #     "03032500",
        #     "01138000",
        #     "05053000",
        #     "11025500",
        #     "01421000",
        #     "05280000",
        #     "07029500",
        #     "06191500",
        #     "03567500",
        #     "14101500",
        #     "03168000",
        #     "10309000",
        #     "07363500",
        #     "06813000",
        #     "11401500",
        #     "05462000",
        #     "02448000",
        #     "03308500",
        #     "06913500",
        #     "06600500",
        #     "12459000",
        #     "10301500",
        #     "01631000",
        #     "04198000",
        #     "08171300",
        #     "07221000",
        #     "02486000",
        #     "06609500",
        #     "03010500",
        #     "03075500",
        #     "03550000",
        #     "05555300",
        #     "08171000",
        #     "13340500",
        #     "02475000",
        #     "05476500",
        #     "03251500",
        #     "03521500",
        #     "13351000",
        #     "03051000",
        #     "07183000",
        #     "02329000",
        #     "05244000",
        #     "01574000",
        #     "03301500",
        #     "07378000",
        #     "02375500",
        #     "06898000",
        #     "01514000",
        #     "02138500",
        #     "02217500",
        #     "03214000",
        #     "07144200",
        #     "09497500",
        #     "12340000",
        #     "02236000",
        #     "03167000",
        #     "08015500",
        #     "02030500",
        #     "08167500",
        #     "05502040",
        #     "07378500",
        #     "06811500",
        #     "13302500",
        #     "03024000",
        #     "14359000",
        #     "07375500",
        #     "01668000",
        #     "01423000",
        #     "01543500",
        #     "06426500",
        #     "04164000",
        #     "06869500",
        #     "05320500",
        #     "08013500",
        #     "11224500",
        #     "07074000",
        #     "03281500",
        #     "01048000",
        #     "03465500",
        #     "02273000",
        #     "07049000",
        #     "09292500",
        #     "07307800",
        #     "04100500",
        #     "05422000",
        #     "05594000",
        #     "10296500",
        #     "11413000",
        #     "04201500",
        #     "02456500",
        #     "07288500",
        #     "03173000",
        #     "07211500",
        #     "07289500",
        #     "03365500",
        #     "08033500",
        #     "01512500",
        #     "04176500",
        #     "11403000",
        #     "02218500",
        #     "04113000",
        #     "03182500",
        #     "03349000",
        #     "06192500",
        #     "05542000",
        #     "02174000",
        #     "03186500",
        #     "11530000",
        #     "06815000",
        #     "03180500",
        #     "14321000",
        #     "03155500",
        #     "03346000",
        #     "11497500",
        #     "07346070",
        #     "03490000",
        #     "05408000",
        #     "03361650",
        #     "05458500",
        #     "01628500",
        #     "05457700",
        #     "01643000",
        #     "12149000",
        #     "01649500",
        #     "06933500",
        #     "07222500",
        #     "01445500",
        #     "01503000",
        #     "02116500",
        #     "02472000",
        #     "05447500",
        #     "03111500",
        #     "06810000",
        #     "06899500",
        #     "03289500",
        #     "02387000",
        #     "03504000",
        #     "12098500",
        #     "01664000",
        #     "07067000",
        #     "06820500",
        #     "03381500",
        #     "06340500",
        #     "01567000",
        #     "08205500",
        #     "12134500",
        #     "04185000",
        #     "05517500",
        #     "07172000",
        #     "07196500",
        #     "05482500",
        #     "04115000",
        #     "05479000",
        #     "08032000",
        #     "14113000",
        #     "01372500",
        #     "07052500",
        #     "03165500",
        #     "02365500",
        #     "07072000",
        #     "07261000",
        #     "01445000",
        #     "02058400",
        #     "02349500",
        #     "01200000",
        #     "05507500",
        #     "07290000",
        #     "05515500",
        #     "02156500",
        #     "03363000",
        #     "01562000",
        #     "10312000",
        #     "01329500",
        #     "03164000",
        # ],
        batch_size=8,
        rho=365,
        var_t=[
            "prcp",
            "map",
            "dayl",
            "srad",
            "swe",
            "tmax",
            "tmin",
            "vp",
        ],
        # var_t_type=["nldas"],
        var_out=["streamflow"],
        var_c=[
            "DRAIN_SQKM",
            "PPTAVG_BASIN",
            "T_AVG_BASIN",
            "T_MAX_BASIN",
            "T_MAXSTD_BASIN",
            "T_MIN_BASIN",
            "T_MINSTD_BASIN",
            "RH_BASIN",
            "PET",
            "GEOL_REEDBUSH_DOM",
            "GEOL_REEDBUSH_DOM_PCT",
            "BFI_AVE",
            "PERDUN",
            "PERHOR",
            "TOPWET",
            "CONTACT",
            "RUNAVE7100",
            "DEVNLCD06",
            "FORESTNLCD06",
            "PLANTNLCD06",
            "IMPNLCD06",
            "HGA",
            "HGB",
            "HGAD",
            "HGC",
            "HGD",
            "HGAC",
            "HGBD",
            "HGCD",
            "HGBC",
            "HGVAR",
            "AWCAVE",
            "PERMAVE",
            "BDAVE",
            "WTDEPAVE",
            "ROCKDEPAVE",
            "ELEV_MEAN_M_BASIN",
            "ELEV_MAX_M_BASIN",
            "ELEV_MIN_M_BASIN",
            "ELEV_MEDIAN_M_BASIN",
            "ELEV_STD_M_BASIN",
            "RRMEAN",
            "RRMEDIAN",
            "SLOPE_PCT",
        ],
        var_to_source_map={
            "dayl(s)": "gages",
            "prcp(mm/day)": "gages",
            "srad(W/m2)": "gages",
            "swe(mm)": "gages",
            "tmax(C)": "gages",
            "tmin(C)": "gages",
            "vp(Pa)": "gages",
            "map(mm/day)": "mopex",
            "pe(mm/day)": "mopex",
            "DRAIN_SQKM": "gages",
            "PPTAVG_BASIN": "gages",
            "T_AVG_BASIN": "gages",
            "T_MAX_BASIN": "gages",
            "T_MAXSTD_BASIN": "gages",
            "T_MIN_BASIN": "gages",
            "T_MINSTD_BASIN": "gages",
            "RH_BASIN": "gages",
            "PET": "gages",
            "GEOL_REEDBUSH_DOM": "gages",
            "GEOL_REEDBUSH_DOM_PCT": "gages",
            "BFI_AVE": "gages",
            "PERDUN": "gages",
            "PERHOR": "gages",
            "TOPWET": "gages",
            "CONTACT": "gages",
            "RUNAVE7100": "gages",
            "DEVNLCD06": "gages",
            "FORESTNLCD06": "gages",
            "PLANTNLCD06": "gages",
            "IMPNLCD06": "gages",
            "HGA": "gages",
            "HGB": "gages",
            "HGAD": "gages",
            "HGC": "gages",
            "HGD": "gages",
            "HGAC": "gages",
            "HGBD": "gages",
            "HGCD": "gages",
            "HGBC": "gages",
            "HGVAR": "gages",
            "AWCAVE": "gages",
            "PERMAVE": "gages",
            "BDAVE": "gages",
            "WTDEPAVE": "gages",
            "ROCKDEPAVE": "gages",
            "ELEV_MEAN_M_BASIN": "gages",
            "ELEV_MAX_M_BASIN": "gages",
            "ELEV_MIN_M_BASIN": "gages",
            "ELEV_MEDIAN_M_BASIN": "gages",
            "ELEV_STD_M_BASIN": "gages",
            "RRMEAN": "gages",
            "RRMEDIAN": "gages",
            "SLOPE_PCT": "gages",
        },
        train_period=["1983-10-01", "1993-09-30"],
        test_period=["1993-10-01", "2003-09-30"],
        dataset="PrecipitationFusionDataset",
        # sampler="KuaiSampler",
        scaler="DapengScaler",
        n_output=1,
        opt="Adam",
        train_epoch=50,
        save_epoch=2,
        fill_nan=["no"],
        model_loader={"load_way": "specified", "test_epoch": 2},
        # lr_scheduler={0: 1, 1: 0.5, 2: 0.2},
        which_first_tensor="sequence",
    )

@pytest.fixture()
def mopex_lstm_args():
    project_name = "test_mopex/exp001"
    source_origin_dir = SETTING["local_data_path"]["datasets-origin"]
    source_interim_dir = SETTING["local_data_path"]["datasets-interim"]
    return cmd(
        sub=project_name,
        source_cfgs={
            "source_names": [
                "gages",
                "mopex",
            ],
            "source_paths": [
                os.path.join(source_origin_dir, "gages"),
                os.path.join(source_origin_dir, "mopex"),
            ],
        },
        ctx=[0],
        model_type="Normal",
        # model_name="ChuFusion",
        model_name="KuaiLSTM",
        # model_hyperparam={
        #     "num_sources": 4,
        #     "out_channels": 2,
        #     "transformer_heads": 4,
        #     "transformer_layers": 2,
        #     "n_input_features": 23,
        #     "n_output_features": 2,
        #     "n_hidden_states": 64,
        #     "layer_hidden_size": 32,
        #     "kernel_size_hydrograph": 3,
        #     "warmup_length": 365,
        #     "param_limit_func": "sigmoid",
        #     "param_test_way": "final",
        #     "source_book": "HF",
        #     "source_type": "sources",
        #     "kernel_size": 3,
        #     "padding": 1,
        # },
        model_hyperparam={
            "n_input_features": 51,
            "n_output_features": 1,
            "n_hidden_states": 256,
        },
        loss_func="RMSESum",
        # gage_id=[
        #     "02475500",
        #     "03069000",
        #     "06894000",
        #     "05554500",
        #     "13298500",
        #     "01560000",
        #     "01064500",
        #     "02383500",
        #     "03238500",
        #     "05592500",],
        gage_id=[
            "01060000",
            "01064500",
            "01076500",
            "01127000",
            "01197500",
            "01321000",
            "01334500",
            "01371500",
            "01372500",
            "01421000",
            "01423000",
            "01426500",
            "01445500",
            "01503000",
            "01512500",
            "01518000",
            "01520000",
            "01531000",
            "01534000",
            "01541000",
            "01541500",
            "01543500",
            "01548500",
            "01556000",
            "01558000",
            "01559000",
            "01560000",
            "01562000",
            "01567000",
            "01574000",
            "01595000",
            "01606500",
            "01608500",
            "01610000",
            "01628500",
            "01631000",
            "01634000",
            "01643000",
            "01649500",
            "01664000",
            "01667500",
            "01668000",
            "01674500",
            "02016000",
            "02018000",
            "02058400",
            "02083500",
            "02102000",
            "02116500",
            "02118000",
            "02126000",
            "02135000",
            "02138500",
            "02143000",
            "02143040",
            "02143500",
            "02156500",
            "02165000",
            "02192000",
            "02202500",
            "02217500",
            "02228000",
            "02236000",
            "02273000",
            "02296750",
            "02329000",
            "02339500",
            "02347500",
            "02349500",
            "02375500",
            "02383500",
            "02387000",
            "02387500",
            "02414500",
            "02472000",
            "02475000",
            "02475500",
            "02478500",
            "02479300",
            "02482000",
            "02492000",
            "03010500",
            "03011020",
            "03020500",
            "03024000",
            "03032500",
            "03050500",
            "03051000",
            "03054500",
            "03069500",
            "03075500",
            "03079000",
            "03109500",
            "03111500",
            "03159500",
            "03161000",
            "03164000",
            "03168000",
            "03173000",
            "03179000",
            "03180500",
            "03182500",
            "03183500",
            "03184000",
            "03186500",
            "03198500",
            "03237500",
            "03238500",
            "03265000",
            "03266000",
            "03269500",
            "03274000",
            "03281500",
            "03301500",
            "03303000",
            "03324300",
            "03326500",
            "03328500",
            "03331500",
            "03339500",
            "03345500",
            "03346000",
            "03349000",
            "03361500",
            "03361650",
            "03362500",
            "03364000",
            "03365500",
            "03381500",
            "03410500",
            "03438000",
            "03443000",
            "03451500",
            "03465500",
            "03473000",
            "03504000",
            "03512000",
            "03524000",
            "03528000",
            "03531500",
            "03540500",
            "03550000",
            "03574500",
            "04073500",
            "04079000",
            "04100500",
            "04113000",
            "04115000",
            "04164000",
            "04165500",
            "04176500",
            "04178000",
            "04185000",
            "04191500",
            "04198000",
            "04201500",
            "04221000",
            "04223000",
            "05053000",
            "05280000",
            "05320500",
            "05408000",
            "05410490",
            "05412500",
            "05418500",
            "05422000",
            "05430500",
            "05435500",
            "05440000",
            "05447500",
            "05451500",
            "05452000",
            "05454500",
            "05455500",
            "05458500",
            "05471500",
            "05472500",
            "05479000",
            "05481000",
            "05482500",
            "05484500",
            "05508000",
            "05514500",
            "05515500",
            "05517000",
            "05517500",
            "05518000",
            "05520500",
            "05526000",
            "05552500",
            "05554500",
            "05555300",
            "05569500",
            "05570000",
            "05582000",
            "05584500",
            "05585000",
            "05592500",
            "05593000",
            "05594000",
            "06191500",
            "06192500",
            "06225500",
            "06334500",
            "06340500",
            "06359500",
            "06441500",
            "06446000",
            "06480000",
            "06600500",
            "06606600",
            "06607200",
            "06609500",
            "06799500",
            "06808500",
            "06810000",
            "06811500",
            "06815000",
            "06817000",
            "06820500",
            "06860000",
            "06869500",
            "06883000",
            "06884400",
            "06885500",
            "06888500",
            "06892000",
            "06894000",
            "06897500",
            "06898000",
            "06899500",
            "06908000",
            "06913500",
            "06933500",
            "07019000",
            "07029500",
            "07052500",
            "07056000",
            "07057500",
            "07067000",
            "07068000",
            "07144200",
            "07144780",
            "07147070",
            "07147800",
            "07152000",
            "07172000",
            "07177500",
            "07183000",
            "07186000",
            "07196500",
            "07197000",
            "07211500",
            "07243500",
            "07261000",
            "07290000",
            "07307800",
            "07340000",
            "07346070",
            "07363500",
            "07375500",
            "07378000",
            "07378500",
            "08015500",
            "08033500",
            "08055500",
            "08085500",
            "08095000",
            "08103800",
            "08167500",
            "08171000",
            "08171300",
            "08172000",
            "08189500",
            "09132500",
            "09251000",
            "09292500",
            "09299500",
            "09430500",
            "09431500",
            "09444500",
            "09497500",
            "10296000",
            "10296500",
            "10301500",
            "10309000",
            "10312000",
            "11025500",
            "11160000",
            "11224500",
            "11342000",
            "11413000",
            "11427000",
            "11501000",
            "11530000",
            "11532500",
            "12027500",
            "12098500",
            "12134500",
            "12144500",
            "12149000",
            "12340000",
            "12358500",
            "12413000",
            "12449950",
            "12459000",
            "12462500",
            "13186000",
            "13200000",
            "13302500",
            "13336500",
            "13337000",
            "13340600",
            "13351000",
            "14113000",
            "14308000",
            "14321000",
            "14359000",
        ],
        # gage_id=[
        #     "02475500",
        #     "03069000",
        #     "06894000",
        #     "05554500",
        #     "13298500",
        #     "01560000",
        #     "01064500",
        #     "02383500",
        #     "03238500",
        #     "05592500",
        #     "03473000",
        #     "05585000",
        #     "03339500",
        #     "13340600",
        #     "13336500",
        #     "03198500",
        #     "07147800",
        #     "06480000",
        #     "03159500",
        #     "05412500",
        #     "03136000",
        #     "05484500",
        #     "05455500",
        #     "05517000",
        #     "01127000",
        #     "03184000",
        #     "02228000",
        #     "01556000",
        #     "01055500",
        #     "02102000",
        #     "07340000",
        #     "01541000",
        #     "06799500",
        #     "02414500",
        #     "01595000",
        #     "02143040",
        #     "03054500",
        #     "03451500",
        #     "03528000",
        #     "03265000",
        #     "07057500",
        #     "07147070",
        #     "11501000",
        #     "01534000",
        #     "04221500",
        #     "11532500",
        #     "12144500",
        #     "06860000",
        #     "08095000",
        #     "05593000",
        #     "01667500",
        #     "03179000",
        #     "06359500",
        #     "01559000",
        #     "05569500",
        #     "12027500",
        #     "04079000",
        #     "11160000",
        #     "01329000",
        #     "08150000",
        #     "12358500",
        #     "03603000",
        #     "01426500",
        #     "03274000",
        #     "06606600",
        #     "06817500",
        #     "07197000",
        #     "03345500",
        #     "01608500",
        #     "03237500",
        #     "01541500",
        #     "02143500",
        #     "08189500",
        #     "06888500",
        #     "05584500",
        #     "03448000",
        #     "02135000",
        #     "08055500",
        #     "03361500",
        #     "11281000",
        #     "03020500",
        #     "06607200",
        #     "03252500",
        #     "06441500",
        #     "06334500",
        #     "08103800",
        #     "11213500",
        #     "03269500",
        #     "14308000",
        #     "03175500",
        #     "01611500",
        #     "05383000",
        #     "05570000",
        #     "03438000",
        #     "01060000",
        #     "11080500",
        #     "01634000",
        #     "06914000",
        #     "07348000",
        #     "11427000",
        #     "03524000",
        #     "07068000",
        #     "08085500",
        #     "03199000",
        #     "06847000",
        #     "04191500",
        #     "03574500",
        #     "02296750",
        #     "05552500",
        #     "06908000",
        #     "04073500",
        #     "01531000",
        #     "08172000",
        #     "02219500",
        #     "04178000",
        #     "06885500",
        #     "02347500",
        #     "01076500",
        #     "07058000",
        #     "02478500",
        #     "05451500",
        #     "01674500",
        #     "07056000",
        #     "03324300",
        #     "06817000",
        #     "14080500",
        #     "12449500",
        #     "08340500",
        #     "01197500",
        #     "07177500",
        #     "05582000",
        #     "09132500",
        #     "04212000",
        #     "02202500",
        #     "02479300",
        #     "03455000",
        #     "01520500",
        #     "01610000",
        #     "05526000",
        #     "06446000",
        #     "02143000",
        #     "01672500",
        #     "05520500",
        #     "03443000",
        #     "09442692",
        #     "03079000",
        #     "03326500",
        #     "12413500",
        #     "02083500",
        #     "03532000",
        #     "06883000",
        #     "03303000",
        #     "06225500",
        #     "02016000",
        #     "05472500",
        #     "05508000",
        #     "03109500",
        #     "01520000",
        #     "06808500",
        #     "04223000",
        #     "03011020",
        #     "02165000",
        #     "12413000",
        #     "13186000",
        #     "07346050",
        #     "06928000",
        #     "08146000",
        #     "07144780",
        #     "07163000",
        #     "06454500",
        #     "03253500",
        #     "02126000",
        #     "04221000",
        #     "11342000",
        #     "14233400",
        #     "01321000",
        #     "03213000",
        #     "03331500",
        #     "13337000",
        #     "14232500",
        #     "02482000",
        #     "03183500",
        #     "03328500",
        #     "02018000",
        #     "03114500",
        #     "02492000",
        #     "03348000",
        #     "05410490",
        #     "07069500",
        #     "03070000",
        #     "01334500",
        #     "04165500",
        #     "01663500",
        #     "01548500",
        #     "11138500",
        #     "05555500",
        #     "01606500",
        #     "03362500",
        #     "09299500",
        #     "07186000",
        #     "08150700",
        #     "03065000",
        #     "12449950",
        #     "03364000",
        #     "02339500",
        #     "02387500",
        #     "03161000",
        #     "07019000",
        #     "05452000",
        #     "13200000",
        #     "01518000",
        #     "03540500",
        #     "05418500",
        #     "07346000",
        #     "02118000",
        #     "05481000",
        #     "05440000",
        #     "03050500",
        #     "07243500",
        #     "05514500",
        #     "01558000",
        #     "04183500",
        #     "09251000",
        #     "09431500",
        #     "02192000",
        #     "06892000",
        #     "03512000",
        #     "04144000",
        #     "01500500",
        #     "07252000",
        #     "05471500",
        #     "11355500",
        #     "12462500",
        #     "03470000",
        #     "03069500",
        #     "09430500",
        #     "07152000",
        #     "03410500",
        #     "02055000",
        #     "05518000",
        #     "03266000",
        #     "05435500",
        #     "05430500",
        #     "06884400",
        #     "03531500",
        #     "06897500",
        #     "09444500",
        #     "10296000",
        #     "05454500",
        #     "01348000",
        #     "01371500",
        #     "03032500",
        #     "01138000",
        #     "05053000",
        #     "11025500",
        #     "01421000",
        #     "05280000",
        #     "07029500",
        #     "06191500",
        #     "03567500",
        #     "14101500",
        #     "03168000",
        #     "10309000",
        #     "07363500",
        #     "06813000",
        #     "11401500",
        #     "05462000",
        #     "02448000",
        #     "03308500",
        #     "06913500",
        #     "06600500",
        #     "12459000",
        #     "10301500",
        #     "01631000",
        #     "04198000",
        #     "08171300",
        #     "07221000",
        #     "02486000",
        #     "06609500",
        #     "03010500",
        #     "03075500",
        #     "03550000",
        #     "05555300",
        #     "08171000",
        #     "13340500",
        #     "02475000",
        #     "05476500",
        #     "03251500",
        #     "03521500",
        #     "13351000",
        #     "03051000",
        #     "07183000",
        #     "02329000",
        #     "05244000",
        #     "01574000",
        #     "03301500",
        #     "07378000",
        #     "02375500",
        #     "06898000",
        #     "01514000",
        #     "02138500",
        #     "02217500",
        #     "03214000",
        #     "07144200",
        #     "09497500",
        #     "12340000",
        #     "02236000",
        #     "03167000",
        #     "08015500",
        #     "02030500",
        #     "08167500",
        #     "05502040",
        #     "07378500",
        #     "06811500",
        #     "13302500",
        #     "03024000",
        #     "14359000",
        #     "07375500",
        #     "01668000",
        #     "01423000",
        #     "01543500",
        #     "06426500",
        #     "04164000",
        #     "06869500",
        #     "05320500",
        #     "08013500",
        #     "11224500",
        #     "07074000",
        #     "03281500",
        #     "01048000",
        #     "03465500",
        #     "02273000",
        #     "07049000",
        #     "09292500",
        #     "07307800",
        #     "04100500",
        #     "05422000",
        #     "05594000",
        #     "10296500",
        #     "11413000",
        #     "04201500",
        #     "02456500",
        #     "07288500",
        #     "03173000",
        #     "07211500",
        #     "07289500",
        #     "03365500",
        #     "08033500",
        #     "01512500",
        #     "04176500",
        #     "11403000",
        #     "02218500",
        #     "04113000",
        #     "03182500",
        #     "03349000",
        #     "06192500",
        #     "05542000",
        #     "02174000",
        #     "03186500",
        #     "11530000",
        #     "06815000",
        #     "03180500",
        #     "14321000",
        #     "03155500",
        #     "03346000",
        #     "11497500",
        #     "07346070",
        #     "03490000",
        #     "05408000",
        #     "03361650",
        #     "05458500",
        #     "01628500",
        #     "05457700",
        #     "01643000",
        #     "12149000",
        #     "01649500",
        #     "06933500",
        #     "07222500",
        #     "01445500",
        #     "01503000",
        #     "02116500",
        #     "02472000",
        #     "05447500",
        #     "03111500",
        #     "06810000",
        #     "06899500",
        #     "03289500",
        #     "02387000",
        #     "03504000",
        #     "12098500",
        #     "01664000",
        #     "07067000",
        #     "06820500",
        #     "03381500",
        #     "06340500",
        #     "01567000",
        #     "08205500",
        #     "12134500",
        #     "04185000",
        #     "05517500",
        #     "07172000",
        #     "07196500",
        #     "05482500",
        #     "04115000",
        #     "05479000",
        #     "08032000",
        #     "14113000",
        #     "01372500",
        #     "07052500",
        #     "03165500",
        #     "02365500",
        #     "07072000",
        #     "07261000",
        #     "01445000",
        #     "02058400",
        #     "02349500",
        #     "01200000",
        #     "05507500",
        #     "07290000",
        #     "05515500",
        #     "02156500",
        #     "03363000",
        #     "01562000",
        #     "10312000",
        #     "01329500",
        #     "03164000",
        # ],
        batch_size=8,
        rho=365,
        var_t=[
            "map",
            "dayl",
            "srad",
            "swe",
            "tmax",
            "tmin",
            "vp",
        ],
        # var_t_type=["nldas"],
        var_out=["streamflow"],
        var_c=[
            "DRAIN_SQKM",
            "PPTAVG_BASIN",
            "T_AVG_BASIN",
            "T_MAX_BASIN",
            "T_MAXSTD_BASIN",
            "T_MIN_BASIN",
            "T_MINSTD_BASIN",
            "RH_BASIN",
            "PET",
            "GEOL_REEDBUSH_DOM",
            "GEOL_REEDBUSH_DOM_PCT",
            "BFI_AVE",
            "PERDUN",
            "PERHOR",
            "TOPWET",
            "CONTACT",
            "RUNAVE7100",
            "DEVNLCD06",
            "FORESTNLCD06",
            "PLANTNLCD06",
            "IMPNLCD06",
            "HGA",
            "HGB",
            "HGAD",
            "HGC",
            "HGD",
            "HGAC",
            "HGBD",
            "HGCD",
            "HGBC",
            "HGVAR",
            "AWCAVE",
            "PERMAVE",
            "BDAVE",
            "WTDEPAVE",
            "ROCKDEPAVE",
            "ELEV_MEAN_M_BASIN",
            "ELEV_MAX_M_BASIN",
            "ELEV_MIN_M_BASIN",
            "ELEV_MEDIAN_M_BASIN",
            "ELEV_STD_M_BASIN",
            "RRMEAN",
            "RRMEDIAN",
            "SLOPE_PCT",
        ],
        var_to_source_map={
            "dayl(s)": "gages",
            "prcp(mm/day)": "gages",
            "srad(W/m2)": "gages",
            "swe(mm)": "gages",
            "tmax(C)": "gages",
            "tmin(C)": "gages",
            "vp(Pa)": "gages",
            "map(mm/day)": "mopex",
            "pe(mm/day)": "mopex",
            "DRAIN_SQKM": "gages",
            "PPTAVG_BASIN": "gages",
            "T_AVG_BASIN": "gages",
            "T_MAX_BASIN": "gages",
            "T_MAXSTD_BASIN": "gages",
            "T_MIN_BASIN": "gages",
            "T_MINSTD_BASIN": "gages",
            "RH_BASIN": "gages",
            "PET": "gages",
            "GEOL_REEDBUSH_DOM": "gages",
            "GEOL_REEDBUSH_DOM_PCT": "gages",
            "BFI_AVE": "gages",
            "PERDUN": "gages",
            "PERHOR": "gages",
            "TOPWET": "gages",
            "CONTACT": "gages",
            "RUNAVE7100": "gages",
            "DEVNLCD06": "gages",
            "FORESTNLCD06": "gages",
            "PLANTNLCD06": "gages",
            "IMPNLCD06": "gages",
            "HGA": "gages",
            "HGB": "gages",
            "HGAD": "gages",
            "HGC": "gages",
            "HGD": "gages",
            "HGAC": "gages",
            "HGBD": "gages",
            "HGCD": "gages",
            "HGBC": "gages",
            "HGVAR": "gages",
            "AWCAVE": "gages",
            "PERMAVE": "gages",
            "BDAVE": "gages",
            "WTDEPAVE": "gages",
            "ROCKDEPAVE": "gages",
            "ELEV_MEAN_M_BASIN": "gages",
            "ELEV_MAX_M_BASIN": "gages",
            "ELEV_MIN_M_BASIN": "gages",
            "ELEV_MEDIAN_M_BASIN": "gages",
            "ELEV_STD_M_BASIN": "gages",
            "RRMEAN": "gages",
            "RRMEDIAN": "gages",
            "SLOPE_PCT": "gages",
        },
        train_period=["1983-10-01", "1993-09-30"],
        test_period=["1993-10-01", "2003-09-30"],
        dataset="MopexPrecipitationGagesAttrFusionDataset",
        # sampler="KuaiSampler",
        scaler="DapengScaler",
        n_output=1,
        opt="Adam",
        train_epoch=50,
        save_epoch=2,
        fill_nan=["no"],
        model_loader={"load_way": "specified", "test_epoch": 2},
        # lr_scheduler={0: 1, 1: 0.5, 2: 0.2},
        which_first_tensor="sequence",
    )

@pytest.fixture()
def gages_lstm_args():
    project_name = "test_gages/exp001"
    source_origin_dir = SETTING["local_data_path"]["datasets-origin"]
    source_interim_dir = SETTING["local_data_path"]["datasets-interim"]
    return cmd(
        sub=project_name,
        source_cfgs={
            "source_name": "gages",
            "source_path": os.path.join(source_origin_dir, "gages"),
        },
        ctx=[0],
        model_type="Normal",
        # model_name="ChuFusion",
        model_name="KuaiLSTM",
        # model_hyperparam={
        #     "num_sources": 4,
        #     "out_channels": 2,
        #     "transformer_heads": 4,
        #     "transformer_layers": 2,
        #     "n_input_features": 23,
        #     "n_output_features": 2,
        #     "n_hidden_states": 64,
        #     "layer_hidden_size": 32,
        #     "kernel_size_hydrograph": 3,
        #     "warmup_length": 365,
        #     "param_limit_func": "sigmoid",
        #     "param_test_way": "final",
        #     "source_book": "HF",
        #     "source_type": "sources",
        #     "kernel_size": 3,
        #     "padding": 1,
        # },
        model_hyperparam={
            "n_input_features": 51,
            "n_output_features": 1,
            "n_hidden_states": 256,
        },
        loss_func="RMSESum",
        # gage_id=[
        #     "02475500",
        #     "03069000",
        #     "06894000",
        #     "05554500",
        #     "13298500",
        #     "01560000",
        #     "01064500",
        #     "02383500",
        #     "03238500",
        #     "05592500",],
        gage_id=[
            "01060000",
            "01064500",
            "01076500",
            "01127000",
            "01197500",
            "01321000",
            "01334500",
            "01371500",
            "01372500",
            "01421000",
            "01423000",
            "01426500",
            "01445500",
            "01503000",
            "01512500",
            "01518000",
            "01520000",
            "01531000",
            "01534000",
            "01541000",
            "01541500",
            "01543500",
            "01548500",
            "01556000",
            "01558000",
            "01559000",
            "01560000",
            "01562000",
            "01567000",
            "01574000",
            "01595000",
            "01606500",
            "01608500",
            "01610000",
            "01628500",
            "01631000",
            "01634000",
            "01643000",
            "01649500",
            "01664000",
            "01667500",
            "01668000",
            "01674500",
            "02016000",
            "02018000",
            "02058400",
            "02083500",
            "02102000",
            "02116500",
            "02118000",
            "02126000",
            "02135000",
            "02138500",
            "02143000",
            "02143040",
            "02143500",
            "02156500",
            "02165000",
            "02192000",
            "02202500",
            "02217500",
            "02228000",
            "02236000",
            "02273000",
            "02296750",
            "02329000",
            "02339500",
            "02347500",
            "02349500",
            "02375500",
            "02383500",
            "02387000",
            "02387500",
            "02414500",
            "02472000",
            "02475000",
            "02475500",
            "02478500",
            "02479300",
            "02482000",
            "02492000",
            "03010500",
            "03011020",
            "03020500",
            "03024000",
            "03032500",
            "03050500",
            "03051000",
            "03054500",
            "03069500",
            "03075500",
            "03079000",
            "03109500",
            "03111500",
            "03159500",
            "03161000",
            "03164000",
            "03168000",
            "03173000",
            "03179000",
            "03180500",
            "03182500",
            "03183500",
            "03184000",
            "03186500",
            "03198500",
            "03237500",
            "03238500",
            "03265000",
            "03266000",
            "03269500",
            "03274000",
            "03281500",
            "03301500",
            "03303000",
            "03324300",
            "03326500",
            "03328500",
            "03331500",
            "03339500",
            "03345500",
            "03346000",
            "03349000",
            "03361500",
            "03361650",
            "03362500",
            "03364000",
            "03365500",
            "03381500",
            "03410500",
            "03438000",
            "03443000",
            "03451500",
            "03465500",
            "03473000",
            "03504000",
            "03512000",
            "03524000",
            "03528000",
            "03531500",
            "03540500",
            "03550000",
            "03574500",
            "04073500",
            "04079000",
            "04100500",
            "04113000",
            "04115000",
            "04164000",
            "04165500",
            "04176500",
            "04178000",
            "04185000",
            "04191500",
            "04198000",
            "04201500",
            "04221000",
            "04223000",
            "05053000",
            "05280000",
            "05320500",
            "05408000",
            "05410490",
            "05412500",
            "05418500",
            "05422000",
            "05430500",
            "05435500",
            "05440000",
            "05447500",
            "05451500",
            "05452000",
            "05454500",
            "05455500",
            "05458500",
            "05471500",
            "05472500",
            "05479000",
            "05481000",
            "05482500",
            "05484500",
            "05508000",
            "05514500",
            "05515500",
            "05517000",
            "05517500",
            "05518000",
            "05520500",
            "05526000",
            "05552500",
            "05554500",
            "05555300",
            "05569500",
            "05570000",
            "05582000",
            "05584500",
            "05585000",
            "05592500",
            "05593000",
            "05594000",
            "06191500",
            "06192500",
            "06225500",
            "06334500",
            "06340500",
            "06359500",
            "06441500",
            "06446000",
            "06480000",
            "06600500",
            "06606600",
            "06607200",
            "06609500",
            "06799500",
            "06808500",
            "06810000",
            "06811500",
            "06815000",
            "06817000",
            "06820500",
            "06860000",
            "06869500",
            "06883000",
            "06884400",
            "06885500",
            "06888500",
            "06892000",
            "06894000",
            "06897500",
            "06898000",
            "06899500",
            "06908000",
            "06913500",
            "06933500",
            "07019000",
            "07029500",
            "07052500",
            "07056000",
            "07057500",
            "07067000",
            "07068000",
            "07144200",
            "07144780",
            "07147070",
            "07147800",
            "07152000",
            "07172000",
            "07177500",
            "07183000",
            "07186000",
            "07196500",
            "07197000",
            "07211500",
            "07243500",
            "07261000",
            "07290000",
            "07307800",
            "07340000",
            "07346070",
            "07363500",
            "07375500",
            "07378000",
            "07378500",
            "08015500",
            "08033500",
            "08055500",
            "08085500",
            "08095000",
            "08103800",
            "08167500",
            "08171000",
            "08171300",
            "08172000",
            "08189500",
            "09132500",
            "09251000",
            "09292500",
            "09299500",
            "09430500",
            "09431500",
            "09444500",
            "09497500",
            "10296000",
            "10296500",
            "10301500",
            "10309000",
            "10312000",
            "11025500",
            "11160000",
            "11224500",
            "11342000",
            "11413000",
            "11427000",
            "11501000",
            "11530000",
            "11532500",
            "12027500",
            "12098500",
            "12134500",
            "12144500",
            "12149000",
            "12340000",
            "12358500",
            "12413000",
            "12449950",
            "12459000",
            "12462500",
            "13186000",
            "13200000",
            "13302500",
            "13336500",
            "13337000",
            "13340600",
            "13351000",
            "14113000",
            "14308000",
            "14321000",
            "14359000",
        ],
        # gage_id=[
        #     "02475500",
        #     "03069000",
        #     "06894000",
        #     "05554500",
        #     "13298500",
        #     "01560000",
        #     "01064500",
        #     "02383500",
        #     "03238500",
        #     "05592500",
        #     "03473000",
        #     "05585000",
        #     "03339500",
        #     "13340600",
        #     "13336500",
        #     "03198500",
        #     "07147800",
        #     "06480000",
        #     "03159500",
        #     "05412500",
        #     "03136000",
        #     "05484500",
        #     "05455500",
        #     "05517000",
        #     "01127000",
        #     "03184000",
        #     "02228000",
        #     "01556000",
        #     "01055500",
        #     "02102000",
        #     "07340000",
        #     "01541000",
        #     "06799500",
        #     "02414500",
        #     "01595000",
        #     "02143040",
        #     "03054500",
        #     "03451500",
        #     "03528000",
        #     "03265000",
        #     "07057500",
        #     "07147070",
        #     "11501000",
        #     "01534000",
        #     "04221500",
        #     "11532500",
        #     "12144500",
        #     "06860000",
        #     "08095000",
        #     "05593000",
        #     "01667500",
        #     "03179000",
        #     "06359500",
        #     "01559000",
        #     "05569500",
        #     "12027500",
        #     "04079000",
        #     "11160000",
        #     "01329000",
        #     "08150000",
        #     "12358500",
        #     "03603000",
        #     "01426500",
        #     "03274000",
        #     "06606600",
        #     "06817500",
        #     "07197000",
        #     "03345500",
        #     "01608500",
        #     "03237500",
        #     "01541500",
        #     "02143500",
        #     "08189500",
        #     "06888500",
        #     "05584500",
        #     "03448000",
        #     "02135000",
        #     "08055500",
        #     "03361500",
        #     "11281000",
        #     "03020500",
        #     "06607200",
        #     "03252500",
        #     "06441500",
        #     "06334500",
        #     "08103800",
        #     "11213500",
        #     "03269500",
        #     "14308000",
        #     "03175500",
        #     "01611500",
        #     "05383000",
        #     "05570000",
        #     "03438000",
        #     "01060000",
        #     "11080500",
        #     "01634000",
        #     "06914000",
        #     "07348000",
        #     "11427000",
        #     "03524000",
        #     "07068000",
        #     "08085500",
        #     "03199000",
        #     "06847000",
        #     "04191500",
        #     "03574500",
        #     "02296750",
        #     "05552500",
        #     "06908000",
        #     "04073500",
        #     "01531000",
        #     "08172000",
        #     "02219500",
        #     "04178000",
        #     "06885500",
        #     "02347500",
        #     "01076500",
        #     "07058000",
        #     "02478500",
        #     "05451500",
        #     "01674500",
        #     "07056000",
        #     "03324300",
        #     "06817000",
        #     "14080500",
        #     "12449500",
        #     "08340500",
        #     "01197500",
        #     "07177500",
        #     "05582000",
        #     "09132500",
        #     "04212000",
        #     "02202500",
        #     "02479300",
        #     "03455000",
        #     "01520500",
        #     "01610000",
        #     "05526000",
        #     "06446000",
        #     "02143000",
        #     "01672500",
        #     "05520500",
        #     "03443000",
        #     "09442692",
        #     "03079000",
        #     "03326500",
        #     "12413500",
        #     "02083500",
        #     "03532000",
        #     "06883000",
        #     "03303000",
        #     "06225500",
        #     "02016000",
        #     "05472500",
        #     "05508000",
        #     "03109500",
        #     "01520000",
        #     "06808500",
        #     "04223000",
        #     "03011020",
        #     "02165000",
        #     "12413000",
        #     "13186000",
        #     "07346050",
        #     "06928000",
        #     "08146000",
        #     "07144780",
        #     "07163000",
        #     "06454500",
        #     "03253500",
        #     "02126000",
        #     "04221000",
        #     "11342000",
        #     "14233400",
        #     "01321000",
        #     "03213000",
        #     "03331500",
        #     "13337000",
        #     "14232500",
        #     "02482000",
        #     "03183500",
        #     "03328500",
        #     "02018000",
        #     "03114500",
        #     "02492000",
        #     "03348000",
        #     "05410490",
        #     "07069500",
        #     "03070000",
        #     "01334500",
        #     "04165500",
        #     "01663500",
        #     "01548500",
        #     "11138500",
        #     "05555500",
        #     "01606500",
        #     "03362500",
        #     "09299500",
        #     "07186000",
        #     "08150700",
        #     "03065000",
        #     "12449950",
        #     "03364000",
        #     "02339500",
        #     "02387500",
        #     "03161000",
        #     "07019000",
        #     "05452000",
        #     "13200000",
        #     "01518000",
        #     "03540500",
        #     "05418500",
        #     "07346000",
        #     "02118000",
        #     "05481000",
        #     "05440000",
        #     "03050500",
        #     "07243500",
        #     "05514500",
        #     "01558000",
        #     "04183500",
        #     "09251000",
        #     "09431500",
        #     "02192000",
        #     "06892000",
        #     "03512000",
        #     "04144000",
        #     "01500500",
        #     "07252000",
        #     "05471500",
        #     "11355500",
        #     "12462500",
        #     "03470000",
        #     "03069500",
        #     "09430500",
        #     "07152000",
        #     "03410500",
        #     "02055000",
        #     "05518000",
        #     "03266000",
        #     "05435500",
        #     "05430500",
        #     "06884400",
        #     "03531500",
        #     "06897500",
        #     "09444500",
        #     "10296000",
        #     "05454500",
        #     "01348000",
        #     "01371500",
        #     "03032500",
        #     "01138000",
        #     "05053000",
        #     "11025500",
        #     "01421000",
        #     "05280000",
        #     "07029500",
        #     "06191500",
        #     "03567500",
        #     "14101500",
        #     "03168000",
        #     "10309000",
        #     "07363500",
        #     "06813000",
        #     "11401500",
        #     "05462000",
        #     "02448000",
        #     "03308500",
        #     "06913500",
        #     "06600500",
        #     "12459000",
        #     "10301500",
        #     "01631000",
        #     "04198000",
        #     "08171300",
        #     "07221000",
        #     "02486000",
        #     "06609500",
        #     "03010500",
        #     "03075500",
        #     "03550000",
        #     "05555300",
        #     "08171000",
        #     "13340500",
        #     "02475000",
        #     "05476500",
        #     "03251500",
        #     "03521500",
        #     "13351000",
        #     "03051000",
        #     "07183000",
        #     "02329000",
        #     "05244000",
        #     "01574000",
        #     "03301500",
        #     "07378000",
        #     "02375500",
        #     "06898000",
        #     "01514000",
        #     "02138500",
        #     "02217500",
        #     "03214000",
        #     "07144200",
        #     "09497500",
        #     "12340000",
        #     "02236000",
        #     "03167000",
        #     "08015500",
        #     "02030500",
        #     "08167500",
        #     "05502040",
        #     "07378500",
        #     "06811500",
        #     "13302500",
        #     "03024000",
        #     "14359000",
        #     "07375500",
        #     "01668000",
        #     "01423000",
        #     "01543500",
        #     "06426500",
        #     "04164000",
        #     "06869500",
        #     "05320500",
        #     "08013500",
        #     "11224500",
        #     "07074000",
        #     "03281500",
        #     "01048000",
        #     "03465500",
        #     "02273000",
        #     "07049000",
        #     "09292500",
        #     "07307800",
        #     "04100500",
        #     "05422000",
        #     "05594000",
        #     "10296500",
        #     "11413000",
        #     "04201500",
        #     "02456500",
        #     "07288500",
        #     "03173000",
        #     "07211500",
        #     "07289500",
        #     "03365500",
        #     "08033500",
        #     "01512500",
        #     "04176500",
        #     "11403000",
        #     "02218500",
        #     "04113000",
        #     "03182500",
        #     "03349000",
        #     "06192500",
        #     "05542000",
        #     "02174000",
        #     "03186500",
        #     "11530000",
        #     "06815000",
        #     "03180500",
        #     "14321000",
        #     "03155500",
        #     "03346000",
        #     "11497500",
        #     "07346070",
        #     "03490000",
        #     "05408000",
        #     "03361650",
        #     "05458500",
        #     "01628500",
        #     "05457700",
        #     "01643000",
        #     "12149000",
        #     "01649500",
        #     "06933500",
        #     "07222500",
        #     "01445500",
        #     "01503000",
        #     "02116500",
        #     "02472000",
        #     "05447500",
        #     "03111500",
        #     "06810000",
        #     "06899500",
        #     "03289500",
        #     "02387000",
        #     "03504000",
        #     "12098500",
        #     "01664000",
        #     "07067000",
        #     "06820500",
        #     "03381500",
        #     "06340500",
        #     "01567000",
        #     "08205500",
        #     "12134500",
        #     "04185000",
        #     "05517500",
        #     "07172000",
        #     "07196500",
        #     "05482500",
        #     "04115000",
        #     "05479000",
        #     "08032000",
        #     "14113000",
        #     "01372500",
        #     "07052500",
        #     "03165500",
        #     "02365500",
        #     "07072000",
        #     "07261000",
        #     "01445000",
        #     "02058400",
        #     "02349500",
        #     "01200000",
        #     "05507500",
        #     "07290000",
        #     "05515500",
        #     "02156500",
        #     "03363000",
        #     "01562000",
        #     "10312000",
        #     "01329500",
        #     "03164000",
        # ],
        batch_size=8,
        rho=365,
        var_t=[
            "prcp",
            "dayl",
            "srad",
            "swe",
            "tmax",
            "tmin",
            "vp",
        ],
        # var_t_type=["nldas"],
        var_out=["streamflow"],
        var_c=[
            "DRAIN_SQKM",
            "PPTAVG_BASIN",
            "T_AVG_BASIN",
            "T_MAX_BASIN",
            "T_MAXSTD_BASIN",
            "T_MIN_BASIN",
            "T_MINSTD_BASIN",
            "RH_BASIN",
            "PET",
            "GEOL_REEDBUSH_DOM",
            "GEOL_REEDBUSH_DOM_PCT",
            "BFI_AVE",
            "PERDUN",
            "PERHOR",
            "TOPWET",
            "CONTACT",
            "RUNAVE7100",
            "DEVNLCD06",
            "FORESTNLCD06",
            "PLANTNLCD06",
            "IMPNLCD06",
            "HGA",
            "HGB",
            "HGAD",
            "HGC",
            "HGD",
            "HGAC",
            "HGBD",
            "HGCD",
            "HGBC",
            "HGVAR",
            "AWCAVE",
            "PERMAVE",
            "BDAVE",
            "WTDEPAVE",
            "ROCKDEPAVE",
            "ELEV_MEAN_M_BASIN",
            "ELEV_MAX_M_BASIN",
            "ELEV_MIN_M_BASIN",
            "ELEV_MEDIAN_M_BASIN",
            "ELEV_STD_M_BASIN",
            "RRMEAN",
            "RRMEDIAN",
            "SLOPE_PCT",
        ],
        var_to_source_map={
            "dayl(s)": "gages",
            "prcp(mm/day)": "gages",
            "srad(W/m2)": "gages",
            "swe(mm)": "gages",
            "tmax(C)": "gages",
            "tmin(C)": "gages",
            "vp(Pa)": "gages",
            "map(mm/day)": "mopex",
            "pe(mm/day)": "mopex",
            "DRAIN_SQKM": "gages",
            "PPTAVG_BASIN": "gages",
            "T_AVG_BASIN": "gages",
            "T_MAX_BASIN": "gages",
            "T_MAXSTD_BASIN": "gages",
            "T_MIN_BASIN": "gages",
            "T_MINSTD_BASIN": "gages",
            "RH_BASIN": "gages",
            "PET": "gages",
            "GEOL_REEDBUSH_DOM": "gages",
            "GEOL_REEDBUSH_DOM_PCT": "gages",
            "BFI_AVE": "gages",
            "PERDUN": "gages",
            "PERHOR": "gages",
            "TOPWET": "gages",
            "CONTACT": "gages",
            "RUNAVE7100": "gages",
            "DEVNLCD06": "gages",
            "FORESTNLCD06": "gages",
            "PLANTNLCD06": "gages",
            "IMPNLCD06": "gages",
            "HGA": "gages",
            "HGB": "gages",
            "HGAD": "gages",
            "HGC": "gages",
            "HGD": "gages",
            "HGAC": "gages",
            "HGBD": "gages",
            "HGCD": "gages",
            "HGBC": "gages",
            "HGVAR": "gages",
            "AWCAVE": "gages",
            "PERMAVE": "gages",
            "BDAVE": "gages",
            "WTDEPAVE": "gages",
            "ROCKDEPAVE": "gages",
            "ELEV_MEAN_M_BASIN": "gages",
            "ELEV_MAX_M_BASIN": "gages",
            "ELEV_MIN_M_BASIN": "gages",
            "ELEV_MEDIAN_M_BASIN": "gages",
            "ELEV_STD_M_BASIN": "gages",
            "RRMEAN": "gages",
            "RRMEDIAN": "gages",
            "SLOPE_PCT": "gages",
        },
        train_period=["1983-10-01", "1993-09-30"],
        test_period=["1993-10-01", "2003-09-30"],
        dataset="StreamflowDataset",
        # sampler="KuaiSampler",
        scaler="DapengScaler",
        n_output=1,
        opt="Adam",
        train_epoch=50,
        save_epoch=2,
        fill_nan=["no"],
        model_loader={"load_way": "specified", "test_epoch": 2},
        # lr_scheduler={0: 1, 1: 0.5, 2: 0.2},
        which_first_tensor="sequence",
    )
